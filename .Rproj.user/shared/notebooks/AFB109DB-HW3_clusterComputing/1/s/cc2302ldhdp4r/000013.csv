"0","library(ggplot2)"
"0",""
"0","# Function to extract biases from an RDA file"
"0","extract_bias <- function(file) {"
"0","  load(here::here(""data"", file))"
"0","  wald_bias <- sapply(results, function(x) x[1]) "
"0","  boot_bias <- sapply(results, function(x) x[2]) "
"0","  data.frame("
"0","    Method = rep(c(""Wald"", ""Bootstrap""), each = length(wald_bias)),"
"0","    Bias = c(wald_bias, boot_bias)"
"0","  )"
"0","}"
"0",""
"0","# Load all scenarios"
"0","scenarios <- lapply(1:4, function(i) extract_bias(paste0(""scenario_"", i, "".RDA"")))"
"0",""
"0","# Combine into a single dataframe"
"0","bias_data <- do.call(rbind, Map(cbind, scenarios, Scenario = paste0(""Scenario "", 1:4)))"
"0",""
"0","# Compute means and MCSE"
"0","summary_data <- aggregate(Bias ~ Method + Scenario, data = bias_data, FUN = function(x) {"
"0","  c(mean = mean(x), mcse = sd(x) / sqrt(length(x)))"
"0","})"
"0",""
"0","# Convert list columns to separate columns"
"0","summary_data <- do.call(data.frame, summary_data)"
"0","colnames(summary_data) <- c(""Method"", ""Scenario"", ""Mean"", ""MCSE"")"
"0",""
"0","# Create the plot"
"0","ggplot(summary_data, aes(x = Scenario, y = Mean, fill = Method)) +"
"0","  geom_col(position = ""dodge"") +"
"0","  geom_errorbar(aes(ymin = Mean - MCSE, ymax = Mean + MCSE), "
"0","                width = 0.2, position = position_dodge(0.9)) +"
"0","  labs(title = ""Bias Comparison with Monte Carlo Standard Error"","
"0","       y = ""Bias"", x = ""Scenario"") +"
"0","  theme_minimal()"
