"0","# Function to extract coverage from the RDA files and compute Type I error"
"0","extract_type1_error_from_coverage <- function(file) {"
"0","  load(here::here(""data"", file))"
"0","  wald_coverage <- sapply(results, function(x) x[7])  "
"0","  boot_coverage <- sapply(results, function(x) x[8]) "
"0","  "
"0","  # Compute Type I error as 1 - coverage"
"0","  wald_type1_error <- 1 - wald_coverage"
"0","  boot_type1_error <- 1 - boot_coverage"
"0","  "
"0","  data.frame("
"0","    Method = rep(c(""Wald"", ""Bootstrap""), each = length(wald_type1_error)),"
"0","    Type1Error = c(wald_type1_error, boot_type1_error)"
"0","  )"
"0","}"
"0",""
"0","# Load only the scenarios under null hypothesis (Scenario 1 and Scenario 3)"
"0","type1_error_scenarios <- lapply(c(1, 3), function(i) extract_type1_error_from_coverage(paste0(""scenario_"", i, "".RDA"")))"
"0",""
"0","# Combine Type I error data into a single dataframe"
"0","type1_error_data <- do.call(rbind, Map(cbind, type1_error_scenarios, Scenario = paste0(""Scenario "", c(1, 3))))"
"0",""
"0","# Compute means and MCSE for Type I error"
"0","type1_error_summary_data <- aggregate(Type1Error ~ Method + Scenario, data = type1_error_data, FUN = function(x) {"
"0","  c(mean = mean(x), mcse = sd(x) / sqrt(length(x)))"
"0","})"
"0",""
"0","# Convert list columns to separate columns"
"0","type1_error_summary_data <- do.call(data.frame, type1_error_summary_data)"
"0","colnames(type1_error_summary_data) <- c(""Method"", ""Scenario"", ""Mean"", ""MCSE"")"
"0",""
"0","# Create the plot for Type I error"
"0","ggplot(type1_error_summary_data, aes(x = Scenario, y = Mean, fill = Method)) +"
"0","  geom_col(position = ""dodge"") +"
"0","  geom_errorbar(aes(ymin = Mean - MCSE, ymax = Mean + MCSE), "
"0","                width = 0.2, position = position_dodge(0.9)) +"
"0","  labs(title = ""Type I Error Comparison (Based on Coverage of 0) with Monte Carlo Standard Error"","
"0","       y = ""Type I Error Rate"", x = ""Scenario"") +"
"0","  theme_minimal()"
"0",""
